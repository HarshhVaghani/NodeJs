<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>To-Do App</title>
  <link rel="stylesheet" href="/style.css" />
</head>
<body>

  <main class="app">
    <header class="header">
      <h1>My Tasks</h1>
      <p><%= todos.length %> tasks</p>
    </header>

    <form action="/add" method="POST" class="add-task">
      <input
        type="text"
        name="task"
        placeholder="What do you want to do today?"
        required
      />
      <button class="btn">Add Task</button>
    </form>

    <ul class="task-list">
      <% todos.forEach((todo, index) => { %>
        <li class="task">

          <form
            action="/edit/<%= index %>"
            method="POST"
            class="edit-form"
          >
            <input
              type="text"
              name="updatedTask"
              value="<%= todo %>"
              required
            />
            <button class="edit" title="Save changes">Edit</button>
          </form>

          <form
            action="/delete/<%= index %>"
            method="POST"
            onsubmit="return confirmDelete()"
          >
            <button class="delete" title="Delete task">Delete</button>
          </form>

        </li>
      <% }) %>

      <% if (todos.length === 0) { %>
        <p class="empty">No tasks yet. Add one </p>
      <% } %>
    </ul>
  </main>

 <script>
  function enableEdit(btn) {
    const form = btn.closest(".edit-form");
    const input = form.querySelector("input");
    const saveBtn = form.querySelector(".save");

    input.removeAttribute("readonly");
    input.focus();

    btn.classList.add("hidden");
    saveBtn.classList.remove("hidden");
  }

  function saveTask(form) {
    const input = form.querySelector("input");

    if (input.value.trim() === "") {
      alert("Task cannot be empty");
      return false;
    }

    return true; // allow submit
  }

  function confirmDelete() {
    return confirm("Are you sure you want to delete this task?");
  }
</script>


</body>
</html>
